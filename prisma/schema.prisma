// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model AccountMovement {
  id               Int      @id @default(autoincrement())
  date             DateTime //@db.Timestamp (postgree)
  documentNumber   String?
  value            Float
  finished         Boolean
  observations     String   //@db.Text (postgree)
  bankAccountId    Int
  movementCodeId   Int
  entityCode       Int
  accountId        Int

  bankAccount BankAccount @relation(name: "BankAccountToAccountMovement", fields: [bankAccountId], references: [id])
  movementCode MovementCode @relation(name: "MovementCodeToAccountMovement", fields: [movementCodeId], references: [id])
  entity Entity @relation(name: "EntityToAccountMovement", fields: [entityCode], references: [id])
  
  @@index([date])
}

model AccountPlan {
  id          Int      @id @default(autoincrement())
  description String   @unique
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  accountSubPlans AccountSubPlan[] @relation("AccountPlanToAccountSubPlan")
}

model AccountSubPlan {
  id            Int      @id @default(autoincrement())
  description   String
  accountPlanId Int
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  accountPlan AccountPlan @relation(name: "AccountPlanToAccountSubPlan", fields: [accountPlanId], references: [id])

  @@unique([accountPlanId, description])
}

model BankAccount {
  id                 Int      @id @default(autoincrement())
  name               String
  numberBank         Int?
  agency             String?
  agencyDigit        String?
  numberAccount      String?
  numberAccountDigit String?
  addressType        String?
  address            String?
  addressNumber      String?
  addressComplement  String?
  neighborhood       String?
  city               String?
  uf                 String?
  cep                String?
  phones             String?
  contactPerson      String?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  accountMovements AccountMovement[] @relation("BankAccountToAccountMovement")

  @@index([name])
}

model Entity {
  id        Int      @id @default(autoincrement())
  name      String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  accountMovements AccountMovement[] @relation("EntityToAccountMovement")
}

model MovementCode {
  id          Int      @id @default(autoincrement())
  description String
  nature      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  accountMovements AccountMovement[] @relation("MovementCodeToAccountMovement")
}

model Parameter {
  id              Int      @id @default(1)
  uppercaseFields Boolean
  dateLock        DateTime
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@unique([id])
}

model User {
  id          String   @id @default(cuid()) //colocar uuid no postgree
  username    String   @unique
  password    String
  userGroupId Int
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  group UserGroup @relation(name: "UserGroupToUser", fields: [userGroupId], references: [id])
}

model UserGroup {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  isAdmin   Boolean
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  users User[] @relation("UserGroupToUser")
}
